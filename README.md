# Sample Python Application with GitHub Actions CI/CD

This repository demonstrates how to set up a Python application with automated testing, code coverage reports, and Docker image building using GitHub Actions.

## Project Structure

```
sample-python-app/
├── app/
│   ├── __init__.py       # Makes this a Python package
│   ├── app.py            # Main application logic
├── tests/
│   ├── __init__.py       # Makes this a Python package
│   ├── test_app.py       # Unit tests for the application
├── .github/
│   └── workflows/
│       └── test-and-build.yml  # GitHub Actions workflow file
├── Dockerfile            # Docker configuration for the app
├── requirements.txt      # Dependencies for the application
├── coverage.xml          # Coverage report (generated automatically)
├── README.md             # Documentation for the project
├── .gitignore            # Ignored files and folders
```

### **Folder Structure**

- **`app/`**: Contains the main Python application logic (e.g., `app.py`).
- **`tests/`**: Contains unit tests for the application (e.g., `test_app.py`).
- **`.github/workflows/`**: GitHub Actions workflow file that automates testing, coverage, and Docker image building.
- **`Dockerfile`**: Defines the Docker image for the application.
- **`requirements.txt`**: Lists Python dependencies such as `coverage` and `unittest2`.
- **`coverage.xml`**: The coverage report generated by the `coverage` tool.
- **`README.md`**: Documentation for the project.
- **`.gitignore`**: Specifies files to be ignored by Git.

---

## Setup Instructions

### **1. Install Dependencies**

To install the required Python dependencies, run:

```bash
pip install -r requirements.txt
```

This will install:
- `unittest2` (for enhanced testing functionality)
- `coverage` (for measuring code coverage)

### **2. Running the Tests Locally**

You can run the tests locally using:

```bash
python -m unittest discover
```

This will discover and run all the test cases inside the `tests/` folder.

To run tests with coverage:

```bash
coverage run -m unittest discover
coverage report
coverage html   # Generates an HTML report (optional)
```

---

## GitHub Actions Workflow

### **1. Workflow Overview**

This repository uses GitHub Actions to automate the following tasks:
- **Unit Test Execution**: Runs unit tests and generates a code coverage report.
- **Coverage Reporting**: Uploads a coverage report as a comment on the pull request.
- **Docker Image Building**: Builds and pushes a Docker image to Docker Hub when a pull request is merged into a protected branch.

### **2. Workflow Details**

The workflow is defined in `.github/workflows/test-and-build.yml` and runs on every pull request targeting the `main` or `protected-branch-name` branch. Here's what it does:

1. **Checkout Code**: Fetches the latest changes.
2. **Setup Python**: Installs Python and dependencies.
3. **Run Tests and Coverage**: Executes unit tests and generates a coverage report.
4. **Upload Coverage Report**: Posts the code coverage report as a PR comment.
5. **Build and Push Docker Image**: On a successful PR merge, builds the Docker image and pushes it to Docker Hub.

---

## Docker Setup

### **1. Dockerfile**

The `Dockerfile` in the root directory specifies how to containerize the Python application. Here's a basic example:

```dockerfile
FROM python:3.9-slim

WORKDIR /app

COPY . .

CMD ["python", "-m", "unittest", "discover"]
```

This file builds an image with Python and runs the tests when the container starts.

### **2. Building and Pushing Docker Image**

After merging a PR into a protected branch (e.g., `main`), the GitHub Actions workflow builds and pushes a Docker image to Docker Hub. The image is tagged with the commit SHA.

---

## Contribution

Feel free to fork this repository and open a pull request if you'd like to contribute. Ensure that all tests pass and the coverage is up to date before submitting.

---

## License

This project is licensed under the MIT License - see the [LICENSE](LICENSE) file for details.

---

This README provides an overview of how your project is structured and how to use GitHub Actions for automation. Let me know if you need any additions or changes!